<div>
	<script type="text/javascript">
		function sichern() {
			localStorage.setItem("nachricht", document.forms.form.elements.nachricht.value);
			//localStorage.setItem("Foto", document.forms.form.elements.foto.value);
			localStorage.setItem("schadensort", document.forms.form.elements.schadensort.value);
			localStorage.setItem("latitude", document.getElementById("lati").innerHTML);
			localStorage.setItem("longitude", document.getElementById("longi").innerHTML);
			document.getElementById("my-awesome-dropzone").submit();
			location.href = "index.php?inc=kontrolle";
		}
	</script>
	<div class="container jumbotron">
		<div class="row clearfix">
			<div class="ueberschrift">
				<h3>
					Bitte geben Sie den Schadensort an.
				</h3>
				<h4>
					*Pflichtfelder
				</h4>
			</div>
		</div>
		<div class="row clearfix">
			<div class="col-md-6 column">
				<form role="form" method="post" name="form" id="form" action="" onsubmit="sichern(); return false;">
					<div class="form-group" id="divnachricht">
						<label id="zeichen" name="zeichen">Ihre Nachricht (Noch 1024 Zeichen):</label><br>
						<textarea id="nachricht" name="nachricht" placeholder="Ihre Nachricht/ Beschwerde/ Anregung/ Idee eingeben" cols="35" rows="4"
						maxlength="1024"></textarea><br>
					</div>
					<p id="lati" class="lalo" name="lati" hidden></p>
					<p id="longi" class="lalo" name="longi" hidden></p>
					<a href="#" class="btn btn-sm btn-primary btn-lg btn-neu" onclick="leeren();init();gpsCheck();" type="button">Aktuellen Standort verwenden (GPS)</a> oder
					<a class="btn btn-sm btn-primary btn-lg btn-neu" onclick="setDorsten();" type="button">"Dorsten" als Ort verwenden</a>
					<script>
						function hilfeAnzeigen() {
							alert("GPS-Akivierung unter Andriod:\nEinstellungen - Standort - Ein \n\nGPS-Akivierung unter iOS:\nEinstellungen - Datenschutz - Ortungsdienst - Ein\n\nGPS-Akivierung unter Windows:\nEinstellungen - Ortung - Ein\n\nGPS-Akivierung unter Amazon:\nEinstellungen - Standortbasierte Dienste - Standortbasierte Dienste aktivieren - Ein\n\nGPS-Akivierung in Google Chrome für Desktop:\nRechts oben auf die drei Striche - Einstellungen - Erweiterte Einstellungen anzeigen - \nInhaltseinstellungen - Standort - Abrufen Ihrers physikalischen Standortes für alle Webseiten zulassen");
						}
					</script>
					<label id="gpsfail" hidden>
						<span> Ihr Standort konnte leider nicht bestimmt werden.
							<a onclick="hilfeAnzeigen()" type="button">?</a>
						</span>
					</label>
					<br><br>
					<label class="ueberschrift">Oder manuell eingeben:</label>
					<br>
					<div class="form-group">
						<label id="zeichen">Adresse des Schadenortes* (auch durch Karte auswählbar)</label>
						<p>
							<input class="form-control" id="schadensort" name="schadensort" type="name" onkeydown='deaktivieren("change")' value="" maxlength="128">
						</p>
						<input type="button" class="btn btn-sm btn-primary btn-lg btn-neu" value="Adresse auf Karte anzeigen" onclick="coordsByAddress();">
					</div>
					<script type="text/javascript">
						function aktivieren() {
							var weiter = $("#weiter");
							weiter.removeAttr("disabled");
							$("#rueckmeldung").attr("hidden", true);
						}

						function deaktivieren(reason) {
							var weiter = $("#weiter");
							weiter.attr("disabled", true);
							var rueckmeldung = $("#rueckmeldung");
							rueckmeldung.removeAttr("hidden");
							if (reason == "change") {
								rueckmeldung.html("Bitte geben Sie einen Schadensort an.");
							}
							if (reason == "nichtDorsten") {
								rueckmeldung.html("Der angegebene Schadensort ist nicht in Dorsten.");
							}
						}
					</script>
					<div align="right">
						<label id="rueckmeldung" style="color: red">Bitte geben Sie einen Schadensort an</label>
					</div>
					<p><input type="submit" id="weiter" class="btn btn-primary btn-lg" disabled name="submit" style="float:right" value="Weiter"></p><br><br><br>
				</form>
			</div>
			<div class="col-md-6 column mapdiv"><br>
				<p>
					<div id="basicMap" class="mapcontainer"></div>
				</p>
				<script type="text/javascript" src="js/desktop_complaint_functions.js"></script>
			</div>
		</div>
		<form id="my-awesome-dropzone" action="upload.php" class="dropzone hochladen">
			<div class="dropzone-previews"></div>
			<div class="fallback"> <!--   this is the fallback if JS isn't working -->
				<input name="file" type="file">
			</div>
		</form>

		<script>
			// myDropzone is the configuration for the element that has an id attribute
			// with the value my-dropzone (or myDropzone)
			Dropzone.options.myAwesomeDropzone = {
				init: function () {
					this.on("addedfile", function (file) {
				// Create the remove button
				var removeButton = Dropzone.createElement("<button>Löschen</button>");
				// Capture the Dropzone instance as closure.
				var _this = this;
				// Listen to the click event
				removeButton.addEventListener("click", function (e) {
					// Make sure the button click doesn't submit the form:
					e.preventDefault();
					e.stopPropagation();
					// Remove the file preview.
					_this.removeFile(file);
					// If you want to the delete the file on the server as well,
					// you can do the AJAX request here.
				});
					// Add the button to the file preview element.
					file.previewElement.appendChild(removeButton);
				});
				}
			};
		</script>
	</div>
</div>

<script type="text/javascript">
	// on document ready
	$(function() {
		mapping();
		deaktivieren('change');
		localStorage.setItem('foto','');
	});
</script>